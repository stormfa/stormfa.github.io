{"version":3,"sources":["webpack:///src/views/banner/index.vue","webpack:///./src/views/banner/index.vue?6f3f","webpack:///./src/views/banner/index.vue"],"names":["banner","name","components","data","tk_logo","tk_logo_default","a","loading","currentPage","pageSize","total","imgUrl","curImgId","myHeaders","Authorization","Object","auth","created","this","loadData","methods","_this","tkpro","then","res","code","$message","error","message","list","console","log","JSON","parse","stringify_default","catch","beforeUpload","item","id","handleSuccess","file","_this2","input","url","success","handleFirstSuccess","_this3","length","deleteAdvertise","_this4","views_banner","render","_vm","_h","$createElement","_c","_self","directives","rawName","value","expression","staticClass","_l","index","key","_v","_s","attrs","src","_e","show-file-list","action","headers","before-upload","on-success","limit","size","type","slot","on","click","$event","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/11.ae5178f6b1d0aee752f7.js","sourcesContent":["<template>\n  <div class=\"banner-list\" v-loading=\"loading\">\n    <template>\n      <!-- 展示 + 编辑 -->\n      <div class=\"panel\" v-for=\"(item, index) in imgUrl\" :key=\"index\">\n        <div class=\"title\">BANNER{{index + 1}}：</div>\n        <img :src=\"item.url\" v-if=\"item.url\">\n        <el-upload\n          class=\"upload-demo\"\n          :show-file-list=\"false\"\n          action=\"https://tuan.taokepro.cn/minio/img/upload\"\n          :headers=\"myHeaders\"\n          :before-upload=\"beforeUpload(item)\"\n          :on-success=\"handleSuccess\"\n          :limit=\"1\">\n          <el-button size=\"small\" type=\"primary\">修改</el-button>\n          <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过500kb</div>\n        </el-upload>\n        <el-button class=\"delete\" @click=\"deleteAdvertise(item)\" size=\"small\" type=\"danger\">删除</el-button>\n      </div>\n      <!-- 添加 -->\n      <div class=\"panel\">\n        <div class=\"title\"></div>\n        <div class=\"empty\"></div>\n        <el-upload\n          class=\"upload-demo\"\n          :show-file-list=\"false\"\n          action=\"https://tuan.taokepro.cn/minio/img/upload\"\n          :headers=\"myHeaders\"\n          :on-success=\"handleFirstSuccess\"\n          :limit=\"1\">\n          <el-button size=\"small\" type=\"primary\">添加</el-button>\n          <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过500kb</div>\n        </el-upload>\n      </div>\n    </template>\n  </div>\n</template>\n\n<script>\nimport { getToken } from '@/utils/auth'\nimport { fetchAdvertiseInfo, addAdvertiseInfo, updateAdvertiseInfo, deleteAdvertiseInfo } from '@/api/tkpro'\nimport tk_logo from '@/assets/images/tk_logo.jpg';\nexport default {\n  name: 'banner-list',\n  components: {\n  },\n  data() {\n    return {\n      tk_logo,\n      loading: false,\n      name: '',\n      currentPage: 1,\n      pageSize: 10,\n      total: 0,\n      imgUrl: [],\n      curImgId: -1,\n      myHeaders: {Authorization: getToken()},\n    }\n  },\n  created(){\n    this.loadData()\n  },\n  methods:{\n    loadData () {\n      this.loading = true\n      fetchAdvertiseInfo(this.name, this.currentPage).then(res => {\n        if (res.code !== 200) return this.$message.error(res.message);\n        this.imgUrl = res.data.list\n        // if (this.dataArray.length === 0) this.dataArray.push(1)\n        this.total = res.data.total\n        // this.pageSize = res.data.pageSize\n        console.log(JSON.parse(JSON.stringify(this.imgUrl)));\n        this.loading = false\n      }).catch(error => {\n        console.log(error);\n        this.loading = false\n      })\n    },\n    beforeUpload (item) {\n      this.curImgId = item.id\n    },\n    handleSuccess(res, file) { // action 上传时的回调\n      this.loading = true\n      if (res.code == '200') {\n        const input = {\n          \"url\": res.data[0].url,\n          \"id\": this.curImgId\n        }\n        updateAdvertiseInfo(input).then(res => {\n          if (res.code !== 200) return this.$message.error(res.message);\n          this.loadData()\n          this.$message.success(res.message || '操作成功');\n          this.loading = false\n        }).catch(error => {\n          console.log(error);\n          this.loading = false\n        })\n      } else {\n        this.$message.error(res.message || '文件导入失败，稍后重试');\n        this.loading = false\n      }\n    },\n    handleFirstSuccess (res, file) { // action 上传时的回调\n      this.loading = true\n      if (res.code == '200') {\n        const url = res.data[0].url\n        const name = `Banner${this.imgUrl.length + 1}`\n        const input = {\n          \"url\": url,\n          \"name\": name,\n\t        \"id\": 0\n        }\n        addAdvertiseInfo(name, input).then(res => {\n          if (res.code !== 200) return this.$message.error(res.message);\n          this.loadData()\n          this.$message.success(res.message || '操作成功');\n          this.loading = false\n        }).catch(error => {\n          console.log(error);\n          this.loading = false\n        })\n      } else {\n        this.$message.error(res.message || '文件导入失败，稍后重试');\n        this.loading = false\n      }\n    },\n    deleteAdvertise (item) {\n      this.loading = true\n      deleteAdvertiseInfo(item.id).then(res => {\n        if (res.code !== 200) return this.$message.error(res.message);\n        this.loadData()\n        this.$message.success(res.message || '操作成功');\n        this.loading = false\n      }).catch(error => {\n        console.log(error);\n        this.loading = false\n      })\n    }\n  }\n}\n</script>\n\n<style rel=\"stylesheet/scss\" lang=\"scss\" scoped>\n.banner-list {\n  background: #eeeeee;\n  padding: 20px;\n  .panel {\n    margin-bottom: 20px;\n    display: flex;\n    .title {\n      width: 90px;\n      line-height: 33px;\n    }\n    img {\n      width: 300px;\n      height: 150px;\n      border: 1px solid #ddd;\n    }\n    .empty {\n      width: 300px;\n      height: 90px;\n    }\n    .upload-demo {\n      margin: 30px;\n    }\n    .delete {\n      width: 56px;\n      height: 32px;\n      margin-top: 30px;\n    }\n  }\n  .button {\n    width: 358px;\n    height: 48px;\n    border-radius: 4px;\n    background-color: rgba(164, 173, 179, 100);\n    color: rgba(255, 255, 255, 100);\n    font-size: 14px;\n    text-align: center;\n    line-height: 48px;\n    cursor: pointer;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/banner/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"banner-list\"},[[_vm._l((_vm.imgUrl),function(item,index){return _c('div',{key:index,staticClass:\"panel\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"BANNER\"+_vm._s(index + 1)+\"：\")]),_vm._v(\" \"),(item.url)?_c('img',{attrs:{\"src\":item.url}}):_vm._e(),_vm._v(\" \"),_c('el-upload',{staticClass:\"upload-demo\",attrs:{\"show-file-list\":false,\"action\":\"https://tuan.taokepro.cn/minio/img/upload\",\"headers\":_vm.myHeaders,\"before-upload\":_vm.beforeUpload(item),\"on-success\":_vm.handleSuccess,\"limit\":1}},[_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"}},[_vm._v(\"修改\")]),_vm._v(\" \"),_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(\"只能上传jpg/png文件，且不超过500kb\")])],1),_vm._v(\" \"),_c('el-button',{staticClass:\"delete\",attrs:{\"size\":\"small\",\"type\":\"danger\"},on:{\"click\":function($event){return _vm.deleteAdvertise(item)}}},[_vm._v(\"删除\")])],1)}),_vm._v(\" \"),_c('div',{staticClass:\"panel\"},[_c('div',{staticClass:\"title\"}),_vm._v(\" \"),_c('div',{staticClass:\"empty\"}),_vm._v(\" \"),_c('el-upload',{staticClass:\"upload-demo\",attrs:{\"show-file-list\":false,\"action\":\"https://tuan.taokepro.cn/minio/img/upload\",\"headers\":_vm.myHeaders,\"on-success\":_vm.handleFirstSuccess,\"limit\":1}},[_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"}},[_vm._v(\"添加\")]),_vm._v(\" \"),_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(\"只能上传jpg/png文件，且不超过500kb\")])],1)],1)]],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-000fbb44\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/banner/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-000fbb44\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-000fbb44\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-000fbb44\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/banner/index.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}