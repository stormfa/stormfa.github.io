webpackJsonp([2],{"8Hh/":function(e,t){},N3DD:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("mvHQ"),i=s.n(a),l=s("TZVV"),n=s("G0J2"),o=s("jA3A"),r={name:"addProduct",components:{quillEditor:n.quillEditor,SingleUpload:l.a},data:function(){var e=this;return{typeList:[],imgUrl:[],cardImgUrl:[],integral:0,skuArr:[{skuName:"",price:0,rebateRate:0}],shopName:"",productType:"",content:"",productUrl:"",productName:"",editorOption:{modules:{ImageExtend:{name:"file",size:3,action:"/res/imgUpload",response:function(e){return e.data},headers:function(t){t.setRequestHeader("Authorization",e.getCookie("username")?e.getCookie("username").token_type+e.getCookie("username").access_token:"Basic emh4eTp6aHh5")},sizeError:function(){},start:function(){},end:function(){},error:function(){},success:function(){},change:function(e,t){}},toolbar:{container:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["image","video"]]}}}}},created:function(){this.loadData()},methods:{loadData:function(){var e=this;Object(o.j)().then(function(t){if(200!==t.code)return e.$message.error(t.message);e.typeList=t.data,console.log(JSON.parse(i()(e.typeList)))}).catch(function(e){console.log(e)}),Object(o.k)("stormfa").then(function(t){if(200!==t.code)return e.$message.error(t.message);e.integral=t.data.rewardPoint,console.log(e.integral)}).catch(function(e){console.log(e)})},uploadCallback:function(e){this.imgUrl.push(e.url),console.log(this.imgUrl)},uploadCardCallback:function(e){this.cardImgUrl.push(e.url),console.log(this.cardImgUrl)},addGoods:function(){this.$router.push({path:"/pms/addProduct"})},addLine:function(){this.skuArr.push({skuName:"",price:0,rebateRate:0})},removeLine:function(e){this.skuArr.splice(e,1)},handleOk:function(){var e=this;if(""===this.shopName)return this.$message({type:"info",message:"未输入店铺名称"});if(""===this.productUrl)return this.$message({type:"info",message:"未输入商品链接"});if(""===this.productName)return this.$message({type:"info",message:"未输入商品名称"});if(0===this.imgUrl.length)return this.$message({type:"info",message:"未添加商品主图"});if(""===this.productType)return this.$message({type:"info",message:"未选择商品分类"});if(0===this.cardImgUrl.length)return this.$message({type:"info",message:"未添加直播手卡"});if(""===this.skuArr[0].skuName)return this.$message({type:"info",message:"未输入SKU的描述"});if(0===this.skuArr[0].price)return this.$message({type:"info",message:"未输入SKU的原价"});if(0===this.skuArr[0].rebateRate)return this.$message({type:"info",message:"未输入SKU的佣金"});if(""===this.content)return this.$message({type:"info",message:"未输入商品描述"});var t={shopName:this.shopName,albumPics:this.imgUrl.join(","),detailHtml:this.content,name:this.productName,pics:this.cardImgUrl.join(","),productCategoryId:this.productType,productLink:this.productUrl,skuList:this.skuArr};console.log(t),Object(o.b)(t).then(function(t){if(200!==t.code)return e.$message.error(t.message);console.log(JSON.parse(i()(t))),200===t.code&&(e.$message({type:"success",message:"操作成功"}),location.reload())}).catch(function(e){console.log(e)})}}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"add-product"},[s("div",{staticClass:"panel"},[s("div",{staticClass:"title"},[e._v("剩余积分：")]),e._v(" "),s("div",{staticClass:"title"},[e._v(e._s(e.integral))])]),e._v(" "),s("div",{staticClass:"panel"},[s("div",{staticClass:"title"},[e._v("店铺名称：")]),e._v(" "),s("el-input",{staticClass:"input",attrs:{placeholder:"请输入店铺名称"},model:{value:e.shopName,callback:function(t){e.shopName=t},expression:"shopName"}})],1),e._v(" "),s("div",{staticClass:"panel"},[s("div",{staticClass:"title"},[e._v("商品链接：")]),e._v(" "),s("el-input",{staticClass:"input",attrs:{placeholder:"请输入商品链接"},model:{value:e.productUrl,callback:function(t){e.productUrl=t},expression:"productUrl"}})],1),e._v(" "),s("div",{staticClass:"panel"},[s("div",{staticClass:"title"},[e._v("商品名称：")]),e._v(" "),s("el-input",{staticClass:"input",attrs:{placeholder:"请输入名称"},model:{value:e.productName,callback:function(t){e.productName=t},expression:"productName"}})],1),e._v(" "),s("div",{staticClass:"panel"},[s("div",{staticClass:"title"},[e._v("商品主图：")]),e._v(" "),s("SingleUpload",{on:{uploadCallback:e.uploadCallback}})],1),e._v(" "),s("div",{staticClass:"panel"},[s("div",{staticClass:"title"},[e._v("商品分类：")]),e._v(" "),s("el-select",{attrs:{placeholder:"请选择商品分类"},model:{value:e.productType,callback:function(t){e.productType=t},expression:"productType"}},e._l(e.typeList,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),s("div",{staticClass:"panel"},[s("div",{staticClass:"title"},[e._v("SKU：")]),e._v(" "),s("div",{staticClass:"panel",staticStyle:{"flex-direction":"column"}},e._l(e.skuArr,function(t,a){return s("div",{key:a,staticClass:"line",staticStyle:{"margin-bottom":"5px"}},[s("el-input",{staticClass:"sku",attrs:{placeholder:"单行输入"},model:{value:t.skuName,callback:function(s){e.$set(t,"skuName",s)},expression:"item.skuName"}}),e._v(" "),s("div",{staticClass:"price"},[e._v("原价：")]),e._v(" "),s("el-input-number",{attrs:{min:0,label:"单行输入"},model:{value:t.price,callback:function(s){e.$set(t,"price",s)},expression:"item.price"}}),e._v(" "),s("div",{staticClass:"commission"},[e._v("佣金率：")]),e._v(" "),s("el-input-number",{attrs:{min:0,max:100,label:"单行输入"},model:{value:t.rebateRate,callback:function(s){e.$set(t,"rebateRate",s)},expression:"item.rebateRate"}}),e._v(" "),s("div",{staticClass:"percentage"},[e._v("%")]),e._v(" "),0===a?s("el-button",{staticClass:"add",attrs:{type:"primary"},on:{click:e.addLine}},[e._v("添加")]):e._e(),e._v(" "),a>0?s("el-button",{staticClass:"add",attrs:{type:"danger"},on:{click:function(t){return e.removeLine(a)}}},[e._v("删除")]):e._e()],1)}),0)]),e._v(" "),s("div",{staticClass:"panel"},[s("div",{staticClass:"title"},[e._v("直播手卡：")]),e._v(" "),s("SingleUpload",{on:{uploadCallback:e.uploadCardCallback}})],1),e._v(" "),s("div",{staticClass:"panel quill"},[s("div",{staticClass:"title"},[e._v("商品描述：")]),e._v(" "),s("quill-editor",{ref:"text",staticClass:"myQuillEditor",attrs:{options:e.editorOption},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1),e._v(" "),s("div",{staticClass:"panel"},[s("div",{staticClass:"title"}),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.handleOk}},[e._v("添加商品")]),e._v(" "),s("div",{staticClass:"tips"},[e._v("添加成功将扣除5积分。")])],1)])},staticRenderFns:[]};var u=s("VU/8")(r,c,!1,function(e){s("OWmK"),s("8Hh/")},"data-v-20f694e2",null);t.default=u.exports},OWmK:function(e,t){},TZVV:function(e,t,s){"use strict";var a=s("jA3A"),i=s("TIfe"),l={name:"singleUpload",props:{},computed:{},data:function(){return{dialogImageUrl:"",dialogVisible:!1,disabled:!1,myHeaders:{Authorization:Object(i.a)()}}},methods:{handleSuccess:function(e,t){"200"==e.code?(this.$emit("uploadCallback",{url:e.data[0].url,name:e.data[0].name}),this.$message.success(e.message||"文件导入成功，稍后查询处理结果")):this.$message.error(e.message||"文件导入失败，稍后重试")},upload:function(){var e=this;Object(a.w)().then(function(t){if(200!==t.code)return e.$message.error(t.message);e.typeList=t.data}).catch(function(e){console.log(e)})},handleRemove:function(e){console.log(e)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleDownload:function(e){console.log(e)}}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-upload",{attrs:{action:"https://tuan.taokepro.cn/minio/img/upload",headers:e.myHeaders,"on-success":e.handleSuccess,"list-type":"picture-card"},scopedSlots:e._u([{key:"file",fn:function(t){var a=t.file;return s("div",{},[s("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:a.url,alt:""}}),e._v(" "),s("span",{staticClass:"el-upload-list__item-actions"},[s("span",{staticClass:"el-upload-list__item-preview",on:{click:function(t){return e.handlePictureCardPreview(a)}}},[s("i",{staticClass:"el-icon-zoom-in"})]),e._v(" "),e.disabled?e._e():s("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleDownload(a)}}},[s("i",{staticClass:"el-icon-download"})]),e._v(" "),e.disabled?e._e():s("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleRemove(a)}}},[s("i",{staticClass:"el-icon-delete"})])])])}}])},[s("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})]),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)},staticRenderFns:[]};var o=s("VU/8")(l,n,!1,function(e){s("prY+")},null,null);t.a=o.exports},"prY+":function(e,t){}});
//# sourceMappingURL=2.7fb400af5391f49d0dd7.js.map